<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Restaurant Menu System</title>
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Arial", sans-serif;
        background-color: #fafafa;
        color: white;
        margin: 0;
        padding: 0;
        display: flex;
        height: 100vh;
      }
      h1 {
        text-align: center;
        color: white;
        font-size: 36px;
        margin-bottom: 20px;
      }
      .left-section {
        width: 250px;
        padding: 20px;
        background-color: #1f1e24;
        box-shadow: 2px 0 5px rgba(0, 0, 0, 0.1);
        display: flex;
        flex-direction: column;
        align-items: flex-start;
        position: relative;
      }
      .logo-text {
        font-size: 28px;
        font-weight: bold;
        color: white;
        margin-bottom: 20px;
        text-align: left;
        display: flex;
        align-items: center;
      }
      .btn,
      .btn1 {
        padding: 12px 24px;
        margin: 10px 0;
        background-color: #ff6347;
        color: white;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-size: 16px;
        box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.1);
        transition: background-color 0.3s, transform 0.3s;
        width: 100%;
        display: flex;
        align-items: center;
        justify-content: flex-start;
      }
      .btn1 i,
      .logo-text i {
        margin-right: 10px;
      }
      .btn:hover,
      .btn1:hover {
        background-color: #6556cd;
        transform: scale(1.05);
      }

      .left-section .btn1:hover {
        background-color: #6556cd;
        transform: scale(1.05);
      }
      .right-section {
        flex-grow: 1;
        padding: 20px;
        background-color: #1f1e24;
        overflow-y: auto;
        margin-left: 20px;
        color: white;
      }
      .btn {
        padding: 12px 24px;
        margin: 10px 0;
        background-color: #ff6347;
        color: white;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-size: 16px;
        box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.1);
        transition: background-color 0.3s, transform 0.3s;
        width: 100%;
      }

      .btn1 {
        padding: 12px 24px;
        margin: 10px 0;
        background-color: transparent;
        border: none;
        color: white;
        border-radius: 8px;
        cursor: pointer;
        font-size: 16px;
        transition: background-color 0.3s, transform 0.3s;
        width: 100%;
      }
      .left-section .btn:hover {
        background-color: #6556cd;
        transform: scale(1.05);
      }

      .left-section .btn1:hover {
        background-color: #6556cd;
        transform: scale(1.05);
      }
      .message-box {
        padding: 15px;
        margin-top: 20px;
        background-color: #f9f9f9;
        border: 1px solid #ddd;
        border-radius: 5px;
        font-size: 16px;
        color: white;
      }
      .order-details,
      .menu {
        margin-top: 20px;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0px 4px 12px rgba(0, 0, 0, 0.1);
        color: white;
      }

      .order-details p,
      .menu p {
        margin: 10px 0;
        font-size: 18px;
        color: white;
      }

      .input-group {
        margin-top: 20px;
      }

      .input-group label {
        display: block;
        font-weight: bold;
        margin-bottom: 8px;
        color: white;
      }

      .input-group input {
        width: 100%;
        padding: 12px;
        border-radius: 8px;
        border: 1px solid #ddd;
        font-size: 16px;
        box-sizing: border-box;
        color: white;
        background-color: #333;
      }
      .menu-item {
        padding: 10px;
        color: white;
        border-radius: 8px;
        margin-bottom: 10px;
        box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.05);
        transition: transform 0.2s ease-in-out;
      }
      .menu-image {
        width: 80px;
        height: 80px;
        border-radius: 8px;
        object-fit: cover;
      }
      .menu-item:hover {
        transform: translateY(-5px);
        box-shadow: 0px 8px 16px rgba(0, 0, 0, 0.1);
        background-color: transparent;
      }

      .menu-item p {
        color: white;
      }

      .total-amount {
        font-size: 22px;
        font-weight: bold;
        color: white;
        margin-top: 20px;
      }
      .welcome-message {
        font-size: 24px;
        font-weight: bold;
        text-align: center;
        color: #ff6347;
        text-transform: uppercase;
        margin-top: 20px;
      }
      .menu-icon {
        font-size: 24px;
        color: #ff6347;
      }
      .thank-you-message {
        font-size: 24px;
        font-weight: bold;
        color: #4CAF50;
        margin-bottom: 20px;
        animation: fadeIn 1s ease-out;
      }
      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }
    </style>
  </head>
  <body>
    <div class="left-section">
      <h3 class="logo-text"><i class="fas fa-cogs"></i>CafeCof</h3>

      <button class="btn1" onclick="showMenu()">
        <i class="fas fa-utensils"></i> Show Menu
      </button>
      <button class="btn1" onclick="showOrderHistory()">
        <i class="fas fa-history"></i> Order History
      </button>
      
     
    </div>

    <div class="divider"></div>

    <div class="right-section" id="output">
      <div class="welcome-message">Welcome to CafeCof!</div>
    </div>
    

    <script>
      const apiUrl = "http://127.0.0.1:5000";

      function showMenu() {
        fetch(`${apiUrl}/menu`)
          .then((response) => response.json())
          .then((data) => {
            const output = document.getElementById("output");
            output.innerHTML = "<h3>Menu</h3>";
            const menuHtml = data.menu
              .map(
                (item) =>
                  `<div class="menu-item">
                             <i class="${item.icon} menu-icon"></i>
                             <p><strong>${item.name}</strong> - ₹${item.price}</p>
                             <p>ID: ${item.id}</p>
                        </div>`
              )
              .join("");
            output.innerHTML += `<div class="menu">${menuHtml}</div>`;
            output.innerHTML += ` 
                        <div class="input-group">
                            <label for="order-ids">Enter Item IDs to order (comma-separated):</label>
                            <input type="text" id="order-ids" placeholder="e.g. 1,2,3" />
                            <button class="btn" onclick="placeOrder()">Place Order</button>
                        </div>
                    `;
          })
          .catch((err) => console.error(err));
      }

      let currentOrder = [];
      let totalAmount = 0;

      function placeOrder() {
        const orderIds = document
          .getElementById("order-ids")
          .value.split(",")
          .map((id) => parseInt(id));
        fetch(`${apiUrl}/order`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ order_ids: orderIds }),
        })
          .then((response) => response.json())
          .then((data) => {
            currentOrder = data.order_details;
            totalAmount = data.total_amount;
            showOrderDetails();
          })
          .catch((err) => console.error(err));
      }

      function showOrderDetails() {
        const output = document.getElementById("output");
        output.innerHTML = "<h3>Your Order</h3>";
        const orderHtml = currentOrder
          .map(
            (item) => `<p>${item.name} - ₹${item.price} (ID: ${item.id})</p>`
          )
          .join("");
        output.innerHTML += `<div class="order-details">${orderHtml}</div>`;
        output.innerHTML += `<p class="total-amount">Total Amount: ₹${totalAmount}</p>`;

        output.innerHTML += ` 
                <div class="input-group">
                    <label for="new-item-id">Add Item ID to Order:</label>
                    <input type="text" id="new-item-id" placeholder="e.g. 1" />
                    <button class="btn" onclick="addNewItem()">Add Item</button>
                </div>
                <div class="input-group">
                    <label for="remove-item-id">Remove Item ID from Order:</label>
                    <input type="text" id="remove-item-id" placeholder="e.g. 2" />
                    <button class="btn" onclick="removeItem()">Remove Item</button>
                </div>
                <button class="btn" onclick="confirmOrder()">Confirm Order</button>
            `;
      }

      function addNewItem() {
        const newItemId = document.getElementById("new-item-id").value;
        fetch(`${apiUrl}/menu`)
          .then((response) => response.json())
          .then((data) => {
            const item = data.menu.find(
              (item) => item.id === parseInt(newItemId)
            );
            if (item) {
              currentOrder.push(item);
              totalAmount += item.price;
              showOrderDetails();
            } else {
              showMessage("Item not found");
            }
          });
      }

      function removeItem() {
        const removeItemId = document.getElementById("remove-item-id").value;
        const itemIndex = currentOrder.findIndex(
          (item) => item.id === parseInt(removeItemId)
        );
      
        if (itemIndex !== -1) {
          const removedItem = currentOrder.splice(itemIndex, 1)[0]; 
          totalAmount -= removedItem.price;
          showOrderDetails();
        } else {
          showMessage("Item not found in your order");
        }
      }
      
      function showOrderHistory() {
        fetch(`${apiUrl}/order-history`)
          .then((response) => response.json())
          .then((data) => {
            const output = document.getElementById("output");
            output.innerHTML = "<h3>Order History</h3>";
            if (data.order_history.length > 0) {
              const historyHtml = data.order_history
                .map(
                  (order, index) => `
                  <div class="order-history-item">
                    <h4>Order ${index + 1}</h4>
                    <p>Total Amount: ₹${order.total_amount}</p>
                    <div>
                      
                      <ul>
                        ${order.order_details
                          .map((item) => `<li>${item.name} - ₹${item.price}</li>`)
                          .join("")}
                      </ul>
                    </div>
                  </div>`
                )
                .join("");
              output.innerHTML += `<div class="order-history">${historyHtml}</div>`;
            } else {
              output.innerHTML += "<p>No past orders found.</p>";
            }
          })
          .catch((err) => console.error(err));
      }
      function confirmOrder() {
        fetch(`${apiUrl}/confirm-order`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ total_amount: totalAmount }),
        })
          .then((response) => response.json())
          .then((data) => {
            const output = document.getElementById("output");
            output.innerHTML = `
                <div class="thank-you-message">Thank You for Your Order!</div>
                <p class="total-amount">Total Amount: ₹${totalAmount}</p>
            `;
          });
      }

      
      function showMessage(message) {
        const output = document.getElementById("output");
        output.innerHTML += `<div class="message-box">${message}</div>`;
      }
      
    </script>
  </body>
</html>
